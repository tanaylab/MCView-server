# Run as the shiny user
run_as shiny;

# Preserve logs when restarting apps
preserve_logs true;

app_init_timeout 600000;

# Define the main server
server {
    # Listen on port 3838
    listen 3838 0.0.0.0;

    # Define the location of applications
    location / {
        # Directory containing Shiny applications
        site_dir /srv/shiny-server/apps;

        # Directory for log files
        log_dir /var/log/shiny-server;

        # Show directory index when visiting base URL
        directory_index on;

        # Log file permissions
        log_file_mode 0774;

        # Application settings
        app_idle_timeout 900;    

        # Allow users to bookmark applications
        bookmark_state_dir /var/lib/shiny-server/bookmarks;
    }
}
